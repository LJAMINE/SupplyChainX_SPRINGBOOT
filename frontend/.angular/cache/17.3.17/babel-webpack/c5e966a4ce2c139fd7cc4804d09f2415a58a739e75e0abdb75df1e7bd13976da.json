{"ast":null,"code":"import { signal, computed } from '@angular/core';\nimport { tap, catchError, of } from 'rxjs';\nimport { environment } from '../../../environments/environment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"@angular/router\";\nexport let AuthService = /*#__PURE__*/(() => {\n  class AuthService {\n    constructor(http, router) {\n      this.http = http;\n      this.router = router;\n      this.TOKEN_KEY = 'accessToken';\n      this.tokenSignal = signal(localStorage.getItem(this.TOKEN_KEY));\n      this.isLoggedIn = computed(() => !!this.tokenSignal());\n    }\n    login(credentials) {\n      return this.http.post(`${environment.apiUrl}/api/auth/login`, credentials, {\n        withCredentials: false\n      }).pipe(tap(res => {\n        if (res?.accessToken) {\n          localStorage.setItem(this.TOKEN_KEY, res.accessToken);\n          this.tokenSignal.set(res.accessToken);\n        }\n      }), catchError(() => of(null)));\n    }\n    logout() {\n      localStorage.removeItem(this.TOKEN_KEY);\n      this.tokenSignal.set(null);\n      this.router.navigate(['/login']);\n    }\n    getToken() {\n      return this.tokenSignal();\n    }\n    static {\n      this.ɵfac = function AuthService_Factory(t) {\n        return new (t || AuthService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.Router));\n      };\n    }\n    static {\n      this.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n        token: AuthService,\n        factory: AuthService.ɵfac,\n        providedIn: 'root'\n      });\n    }\n  }\n  return AuthService;\n})();","map":{"version":3,"names":["signal","computed","tap","catchError","of","environment","AuthService","constructor","http","router","TOKEN_KEY","tokenSignal","localStorage","getItem","isLoggedIn","login","credentials","post","apiUrl","withCredentials","pipe","res","accessToken","setItem","set","logout","removeItem","navigate","getToken","i0","ɵɵinject","i1","HttpClient","i2","Router","factory","ɵfac","providedIn"],"sources":["/home/amine/SupplyChainX/frontend/src/app/core/services/auth.service.ts"],"sourcesContent":["import { Injectable, signal, computed } from '@angular/core';\nimport { HttpClient } from '@angular/common/http';\nimport { Router } from '@angular/router';\nimport { Observable, tap, catchError, of } from 'rxjs';\nimport { environment } from '../../../environments/environment';\n\nexport interface LoginRequest {\n  email: string;\n  password: string;\n}\n\nexport interface AuthResponse {\n  accessToken: string;\n  refreshToken: string;\n}\n\n@Injectable({ providedIn: 'root' })\nexport class AuthService {\n  private readonly TOKEN_KEY = 'accessToken';\n\n  private tokenSignal = signal<string | null>(localStorage.getItem(this.TOKEN_KEY));\n  isLoggedIn = computed(() => !!this.tokenSignal());\n\n  constructor(\n    private http: HttpClient,\n    private router: Router,\n  ) {}\n\n  login(credentials: LoginRequest): Observable<AuthResponse | null> {\n    return this.http\n      .post<AuthResponse>(`${environment.apiUrl}/api/auth/login`, credentials, {\n        withCredentials: false,\n      })\n      .pipe(\n        tap((res) => {\n          if (res?.accessToken) {\n            localStorage.setItem(this.TOKEN_KEY, res.accessToken);\n            this.tokenSignal.set(res.accessToken);\n          }\n        }),\n        catchError(() => of(null)),\n      );\n  }\n\n  logout(): void {\n    localStorage.removeItem(this.TOKEN_KEY);\n    this.tokenSignal.set(null);\n    this.router.navigate(['/login']);\n  }\n\n  getToken(): string | null {\n    return this.tokenSignal();\n  }\n}\n"],"mappings":"AAAA,SAAqBA,MAAM,EAAEC,QAAQ,QAAQ,eAAe;AAG5D,SAAqBC,GAAG,EAAEC,UAAU,EAAEC,EAAE,QAAQ,MAAM;AACtD,SAASC,WAAW,QAAQ,mCAAmC;;;;AAa/D,WAAaC,WAAW;EAAlB,MAAOA,WAAW;IAMtBC,YACUC,IAAgB,EAChBC,MAAc;MADd,KAAAD,IAAI,GAAJA,IAAI;MACJ,KAAAC,MAAM,GAANA,MAAM;MAPC,KAAAC,SAAS,GAAG,aAAa;MAElC,KAAAC,WAAW,GAAGX,MAAM,CAAgBY,YAAY,CAACC,OAAO,CAAC,IAAI,CAACH,SAAS,CAAC,CAAC;MACjF,KAAAI,UAAU,GAAGb,QAAQ,CAAC,MAAM,CAAC,CAAC,IAAI,CAACU,WAAW,EAAE,CAAC;IAK9C;IAEHI,KAAKA,CAACC,WAAyB;MAC7B,OAAO,IAAI,CAACR,IAAI,CACbS,IAAI,CAAe,GAAGZ,WAAW,CAACa,MAAM,iBAAiB,EAAEF,WAAW,EAAE;QACvEG,eAAe,EAAE;OAClB,CAAC,CACDC,IAAI,CACHlB,GAAG,CAAEmB,GAAG,IAAI;QACV,IAAIA,GAAG,EAAEC,WAAW,EAAE;UACpBV,YAAY,CAACW,OAAO,CAAC,IAAI,CAACb,SAAS,EAAEW,GAAG,CAACC,WAAW,CAAC;UACrD,IAAI,CAACX,WAAW,CAACa,GAAG,CAACH,GAAG,CAACC,WAAW,CAAC;QACvC;MACF,CAAC,CAAC,EACFnB,UAAU,CAAC,MAAMC,EAAE,CAAC,IAAI,CAAC,CAAC,CAC3B;IACL;IAEAqB,MAAMA,CAAA;MACJb,YAAY,CAACc,UAAU,CAAC,IAAI,CAAChB,SAAS,CAAC;MACvC,IAAI,CAACC,WAAW,CAACa,GAAG,CAAC,IAAI,CAAC;MAC1B,IAAI,CAACf,MAAM,CAACkB,QAAQ,CAAC,CAAC,QAAQ,CAAC,CAAC;IAClC;IAEAC,QAAQA,CAAA;MACN,OAAO,IAAI,CAACjB,WAAW,EAAE;IAC3B;;;yBAnCWL,WAAW,EAAAuB,EAAA,CAAAC,QAAA,CAAAC,EAAA,CAAAC,UAAA,GAAAH,EAAA,CAAAC,QAAA,CAAAG,EAAA,CAAAC,MAAA;MAAA;IAAA;;;eAAX5B,WAAW;QAAA6B,OAAA,EAAX7B,WAAW,CAAA8B,IAAA;QAAAC,UAAA,EADE;MAAM;IAAA;;SACnB/B,WAAW;AAAA","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}