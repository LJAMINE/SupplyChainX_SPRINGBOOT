"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[70],{1070:(j,d,s)=>{s.r(d),s.d(d,{RawMaterialsComponent:()=>C});var t=s(4438),g=s(177),r=s(4341),m=s(1626),p=s(5312);let _=(()=>{class i{constructor(e){this.http=e,this.base=`${p.c.apiUrl}/api/raw-materials`}list(e,o=0,n=20){let a=(new m.Nl).set("page",o).set("size",n);return e?.trim()&&(a=a.set("s",e.trim())),this.http.get(this.base,{params:a})}get(e){return this.http.get(`${this.base}/${e}`)}create(e){return this.http.post(this.base,e)}update(e,o){return this.http.put(`${this.base}/${e}`,o)}delete(e){return this.http.delete(`${this.base}/${e}`)}static{this.\u0275fac=function(o){return new(o||i)(t.KVO(m.Qq))}}static{this.\u0275prov=t.jDH({token:i,factory:i.\u0275fac,providedIn:"root"})}}return i})();const u=(i,l)=>l.id;function b(i,l){if(1&i){const e=t.RV6();t.j41(0,"tr")(1,"td"),t.EFF(2),t.k0s(),t.j41(3,"td")(4,"span"),t.EFF(5),t.k0s()(),t.j41(6,"td"),t.EFF(7),t.k0s(),t.j41(8,"td"),t.EFF(9),t.k0s(),t.j41(10,"td"),t.EFF(11),t.nI1(12,"date"),t.k0s(),t.j41(13,"td",11)(14,"button",12),t.bIt("click",function(){const n=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.openEditModal(n))}),t.EFF(15,"\u270e"),t.k0s(),t.j41(16,"button",13),t.bIt("click",function(){const n=t.eBV(e).$implicit,a=t.XpG();return t.Njj(a.confirmDelete(n))}),t.EFF(17,"\u2715"),t.k0s()()()}if(2&i){const e=l.$implicit;t.R7$(2),t.JRh(e.name),t.R7$(2),t.AVh("low-stock",e.stock<=e.stockMin),t.R7$(),t.JRh(e.stock),t.R7$(2),t.JRh(e.stockMin),t.R7$(2),t.JRh(e.unit||"-"),t.R7$(2),t.JRh(t.i5U(12,7,e.createdAt,"short"))}}function h(i,l){1&i&&(t.j41(0,"tr")(1,"td",14),t.EFF(2,"No raw materials found"),t.k0s()())}function M(i,l){if(1&i&&(t.j41(0,"div",18),t.EFF(1),t.k0s()),2&i){const e=t.XpG(2);t.R7$(),t.JRh(e.modalError)}}function f(i,l){if(1&i){const e=t.RV6();t.j41(0,"div",15),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.closeModal())}),t.j41(1,"div",16),t.bIt("click",function(n){return t.eBV(e),t.Njj(n.stopPropagation())}),t.j41(2,"h2"),t.EFF(3),t.k0s(),t.j41(4,"form",17,0),t.bIt("ngSubmit",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.save())}),t.DNE(6,M,2,1,"div",18),t.j41(7,"div",19)(8,"label"),t.EFF(9,"Name *"),t.k0s(),t.j41(10,"input",20),t.mxI("ngModelChange",function(n){t.eBV(e);const a=t.XpG();return t.DH7(a.form.name,n)||(a.form.name=n),t.Njj(n)}),t.k0s()(),t.j41(11,"div",21)(12,"div",19)(13,"label"),t.EFF(14,"Stock *"),t.k0s(),t.j41(15,"input",22),t.mxI("ngModelChange",function(n){t.eBV(e);const a=t.XpG();return t.DH7(a.form.stock,n)||(a.form.stock=n),t.Njj(n)}),t.k0s()(),t.j41(16,"div",19)(17,"label"),t.EFF(18,"Min Stock *"),t.k0s(),t.j41(19,"input",23),t.mxI("ngModelChange",function(n){t.eBV(e);const a=t.XpG();return t.DH7(a.form.stockMin,n)||(a.form.stockMin=n),t.Njj(n)}),t.k0s()()(),t.j41(20,"div",19)(21,"label"),t.EFF(22,"Unit"),t.k0s(),t.j41(23,"input",24),t.mxI("ngModelChange",function(n){t.eBV(e);const a=t.XpG();return t.DH7(a.form.unit,n)||(a.form.unit=n),t.Njj(n)}),t.k0s()(),t.j41(24,"div",25)(25,"button",26),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.closeModal())}),t.EFF(26,"Cancel"),t.k0s(),t.j41(27,"button",27),t.EFF(28),t.k0s()()()()()}if(2&i){const e=t.sdS(5),o=t.XpG();t.R7$(3),t.SpI("",o.editId?"Edit":"New"," Raw Material"),t.R7$(3),t.vxM(6,o.modalError?6:-1),t.R7$(4),t.R50("ngModel",o.form.name),t.R7$(5),t.R50("ngModel",o.form.stock),t.R7$(4),t.R50("ngModel",o.form.stockMin),t.R7$(4),t.R50("ngModel",o.form.unit),t.R7$(4),t.Y8G("disabled",e.invalid||o.saving),t.R7$(),t.JRh(o.saving?"Saving...":"Save")}}function k(i,l){if(1&i){const e=t.RV6();t.j41(0,"div",15),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancelDelete())}),t.j41(1,"div",28),t.bIt("click",function(n){return t.eBV(e),t.Njj(n.stopPropagation())}),t.j41(2,"h2"),t.EFF(3),t.k0s(),t.j41(4,"p"),t.EFF(5,"This action cannot be undone."),t.k0s(),t.j41(6,"div",25)(7,"button",26),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.cancelDelete())}),t.EFF(8,"Cancel"),t.k0s(),t.j41(9,"button",29),t.bIt("click",function(){t.eBV(e);const n=t.XpG();return t.Njj(n.doDelete())}),t.EFF(10),t.k0s()()()()}if(2&i){const e=t.XpG();t.R7$(3),t.SpI('Delete "',e.deleteTarget.name,'"?'),t.R7$(6),t.Y8G("disabled",e.deleting),t.R7$(),t.JRh(e.deleting?"Deleting...":"Delete")}}let C=(()=>{class i{constructor(){this.service=(0,t.WQX)(_),this.items=[],this.search="",this.page=0,this.totalPages=1,this.showModal=!1,this.editId=null,this.form={name:"",stock:0,stockMin:0,unit:""},this.saving=!1,this.modalError="",this.deleteTarget=null,this.deleting=!1}ngOnInit(){this.loadPage(0)}loadPage(e){this.page=e,this.service.list(this.search,this.page,20).subscribe({next:o=>{this.items=o.content,this.totalPages=o.totalPages}})}openCreateModal(){this.editId=null,this.form={name:"",stock:0,stockMin:0,unit:""},this.modalError="",this.showModal=!0}openEditModal(e){this.editId=e.id,this.form={name:e.name,stock:e.stock,stockMin:e.stockMin,unit:e.unit||""},this.modalError="",this.showModal=!0}closeModal(){this.showModal=!1}save(){this.saving||(this.saving=!0,this.modalError="",(this.editId?this.service.update(this.editId,this.form):this.service.create(this.form)).subscribe({next:()=>{this.saving=!1,this.closeModal(),this.loadPage(this.page)},error:o=>{this.saving=!1,this.modalError=o?.error?.message||"An error occurred"}}))}confirmDelete(e){this.deleteTarget=e}cancelDelete(){this.deleteTarget=null}doDelete(){!this.deleteTarget||this.deleting||(this.deleting=!0,this.service.delete(this.deleteTarget.id).subscribe({next:()=>{this.deleting=!1,this.deleteTarget=null,this.loadPage(this.page)},error:()=>{this.deleting=!1}}))}static{this.\u0275fac=function(o){return new(o||i)}}static{this.\u0275cmp=t.VBU({type:i,selectors:[["app-raw-materials"]],standalone:!0,features:[t.aNF],decls:36,vars:8,consts:[["f","ngForm"],[1,"page"],[1,"page-header"],["type","button",1,"btn-primary",3,"click"],[1,"toolbar"],["type","text","placeholder","Search...",1,"search-input",3,"ngModelChange","input","ngModel"],[1,"table-wrap"],[1,"table"],[1,"pagination"],[3,"click","disabled"],[1,"modal-backdrop"],[1,"actions"],["type","button","title","Edit",1,"btn-icon",3,"click"],["type","button","title","Delete",1,"btn-icon","btn-danger",3,"click"],["colspan","6",1,"empty"],[1,"modal-backdrop",3,"click"],[1,"modal",3,"click"],[3,"ngSubmit"],[1,"modal-error"],[1,"field"],["name","name","required","",3,"ngModelChange","ngModel"],[1,"field-row"],["type","number","name","stock","min","0","required","",3,"ngModelChange","ngModel"],["type","number","name","stockMin","min","0","required","",3,"ngModelChange","ngModel"],["name","unit","placeholder","e.g. kg, L",3,"ngModelChange","ngModel"],[1,"modal-actions"],["type","button",1,"btn-secondary",3,"click"],["type","submit",1,"btn-primary",3,"disabled"],[1,"modal","modal-sm",3,"click"],["type","button",1,"btn-danger",3,"click","disabled"]],template:function(o,n){1&o&&(t.j41(0,"div",1)(1,"div",2)(2,"h1"),t.EFF(3,"Raw Materials"),t.k0s(),t.j41(4,"button",3),t.bIt("click",function(){return n.openCreateModal()}),t.EFF(5,"+ New Raw Material"),t.k0s()(),t.j41(6,"div",4)(7,"input",5),t.mxI("ngModelChange",function(c){return t.DH7(n.search,c)||(n.search=c),c}),t.bIt("input",function(){return n.loadPage(0)}),t.k0s()(),t.j41(8,"div",6)(9,"table",7)(10,"thead")(11,"tr")(12,"th"),t.EFF(13,"Name"),t.k0s(),t.j41(14,"th"),t.EFF(15,"Stock"),t.k0s(),t.j41(16,"th"),t.EFF(17,"Min Stock"),t.k0s(),t.j41(18,"th"),t.EFF(19,"Unit"),t.k0s(),t.j41(20,"th"),t.EFF(21,"Created"),t.k0s(),t.nrm(22,"th"),t.k0s()(),t.j41(23,"tbody"),t.Z7z(24,b,18,10,"tr",null,u,!1,h,3,0,"tr"),t.k0s()()(),t.j41(27,"div",8)(28,"button",9),t.bIt("click",function(){return n.loadPage(n.page-1)}),t.EFF(29,"\u2190 Prev"),t.k0s(),t.j41(30,"span"),t.EFF(31),t.k0s(),t.j41(32,"button",9),t.bIt("click",function(){return n.loadPage(n.page+1)}),t.EFF(33,"Next \u2192"),t.k0s()()(),t.DNE(34,f,29,8,"div",10)(35,k,11,3,"div",10)),2&o&&(t.R7$(7),t.R50("ngModel",n.search),t.R7$(17),t.Dyx(n.items),t.R7$(4),t.Y8G("disabled",n.page<=0),t.R7$(3),t.Lme("Page ",n.page+1," of ",n.totalPages||1,""),t.R7$(),t.Y8G("disabled",n.page>=(n.totalPages||1)-1),t.R7$(2),t.vxM(34,n.showModal?34:-1),t.R7$(),t.vxM(35,n.deleteTarget?35:-1))},dependencies:[g.MD,g.vh,r.YN,r.qT,r.me,r.Q0,r.BC,r.cb,r.YS,r.VZ,r.vS,r.cV],styles:[".page[_ngcontent-%COMP%]{max-width:1000px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:1.5rem}.page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0;font-size:1.5rem}.toolbar[_ngcontent-%COMP%]{margin-bottom:1rem}.search-input[_ngcontent-%COMP%]{padding:.5rem .75rem;width:280px;border:1px solid #475569;border-radius:6px;background:#1e293b;color:#e2e8f0}.table-wrap[_ngcontent-%COMP%]{overflow-x:auto;border-radius:8px;border:1px solid #334155}.table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:.75rem 1rem;text-align:left;border-bottom:1px solid #334155}.table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{background:#1e293b;color:#94a3b8;font-weight:600;font-size:.8rem;text-transform:uppercase}.table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{background:#0f172a}.table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#1e293b}.low-stock[_ngcontent-%COMP%]{color:#f87171;font-weight:600}.empty[_ngcontent-%COMP%]{color:#64748b;font-style:italic;padding:2rem!important}.actions[_ngcontent-%COMP%]{white-space:nowrap}.btn-icon[_ngcontent-%COMP%]{background:none;border:none;color:#94a3b8;padding:.35rem .5rem;margin-right:.25rem;cursor:pointer;font-size:1rem;border-radius:4px}.btn-icon[_ngcontent-%COMP%]:hover{background:#334155;color:#e2e8f0}.btn-icon.btn-danger[_ngcontent-%COMP%]:hover{background:#7f1d1d;color:#fca5a5}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center;gap:1rem;margin-top:1rem}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{padding:.4rem .75rem;background:#334155;color:#e2e8f0;border:none;border-radius:6px}.pagination[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:disabled{opacity:.5;cursor:not-allowed}.btn-primary[_ngcontent-%COMP%]{padding:.5rem 1rem;background:#38bdf8;color:#0f172a;border:none;border-radius:6px;font-weight:600}.btn-primary[_ngcontent-%COMP%]:hover:not(:disabled){background:#7dd3fc}.btn-secondary[_ngcontent-%COMP%]{padding:.5rem 1rem;background:#334155;color:#e2e8f0;border:none;border-radius:6px}.btn-secondary[_ngcontent-%COMP%]:hover{background:#475569}.btn-danger[_ngcontent-%COMP%]{padding:.5rem 1rem;background:#dc2626;color:#fff;border:none;border-radius:6px}.btn-danger[_ngcontent-%COMP%]:hover:not(:disabled){background:#ef4444}.modal-backdrop[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0009;display:flex;align-items:center;justify-content:center;z-index:1000;padding:1rem}.modal[_ngcontent-%COMP%]{background:#1e293b;border-radius:12px;padding:1.5rem;max-width:440px;width:100%;border:1px solid #334155}.modal[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0 0 1rem;font-size:1.25rem}.modal-error[_ngcontent-%COMP%]{padding:.5rem;background:#ef444426;color:#fca5a5;border-radius:6px;margin-bottom:1rem;font-size:.9rem}.field[_ngcontent-%COMP%]{margin-bottom:1rem}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.35rem;font-size:.875rem;color:#94a3b8}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%;padding:.6rem;border:1px solid #475569;border-radius:6px;background:#0f172a;color:#e2e8f0}.field-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:1rem}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:.75rem;margin-top:1.25rem}.modal-sm[_ngcontent-%COMP%]   .modal-actions[_ngcontent-%COMP%]{margin-top:1rem}"]})}}return i})()}}]);